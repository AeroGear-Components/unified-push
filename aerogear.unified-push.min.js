/*! AeroGear JavaScript Library - v2.0.0-beta1 - 2014-10-09
* https://github.com/aerogear/aerogear-js
* JBoss, Home of Professional Open Source
* Copyright Red Hat, Inc., and individual contributors
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
* http://www.apache.org/licenses/LICENSE-2.0
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
(function(t,e){this.AeroGear={},AeroGear.Core=function(){if(this instanceof AeroGear.Core)throw"Invalid instantiation of base class AeroGear.Core";this.add=function(t){var e,r,n=this[this.collectionName]||{};if(this[this.collectionName]=n,!t)return this;if("string"==typeof t)n[t]=AeroGear[this.lib].adapters[this.type](t,this.config);else if(Array.isArray(t))for(e=0;t.length>e;e++)r=t[e],"string"==typeof r?n[r]=AeroGear[this.lib].adapters[this.type](r,this.config):r.name&&(r.settings=AeroGear.extend(r.settings||{},this.config),n[r.name]=AeroGear[this.lib].adapters[r.type||this.type](r.name,r.settings));else{if(!t.name)return this;t.settings=AeroGear.extend(t.settings||{},this.config),n[t.name]=AeroGear[this.lib].adapters[t.type||this.type](t.name,t.settings)}return this[this.collectionName]=n,this},this.remove=function(t){var e,r,n=this[this.collectionName]||{};if("string"==typeof t)delete n[t];else if(Array.isArray(t))for(e=0;t.length>e;e++)r=t[e],"string"==typeof r?delete n[r]:delete n[r.name];else t&&delete n[t.name];return this[this.collectionName]=n,this}},AeroGear.extend=function(){var t,e,r,n=arguments[0];for(e=1;arguments.length>e;e++){r=arguments[e];for(t in r)n[t]=r[t]}return n},function(){var r,n,i,o;(function(){var t={},e={};r=function(e,r,n){t[e]={deps:r,callback:n}},o=i=n=function(r){function i(t){if("."!==t.charAt(0))return t;for(var e=t.split("/"),n=r.split("/").slice(0,-1),i=0,o=e.length;o>i;i++){var s=e[i];if(".."===s)n.pop();else{if("."===s)continue;n.push(s)}}return n.join("/")}if(o._eak_seen=t,e[r])return e[r];if(e[r]={},!t[r])throw Error("Could not find module "+r);for(var s,a=t[r],c=a.deps,u=a.callback,f=[],l=0,p=c.length;p>l;l++)"exports"===c[l]?f.push(s={}):f.push(n(i(c[l])));var h=u.apply(this,f);return e[r]=s||h}})(),r("promise/all",["./utils","exports"],function(t,e){"use strict";function r(t){var e=this;if(!n(t))throw new TypeError("You must pass an array to all.");return new e(function(e,r){function n(t){return function(e){o(t,e)}}function o(t,r){a[t]=r,0===--c&&e(a)}var s,a=[],c=t.length;0===c&&e([]);for(var u=0;t.length>u;u++)s=t[u],s&&i(s.then)?s.then(n(u),r):o(u,s)})}var n=t.isArray,i=t.isFunction;e.all=r}),r("promise/asap",["exports"],function(r){"use strict";function n(){return function(){process.nextTick(s)}}function i(){var t=0,e=new f(s),r=document.createTextNode("");return e.observe(r,{characterData:!0}),function(){r.data=t=++t%2}}function o(){return function(){l.setTimeout(s,1)}}function s(){for(var t=0;p.length>t;t++){var e=p[t],r=e[0],n=e[1];r(n)}p=[]}function a(t,e){var r=p.push([t,e]);1===r&&c()}var c,u=t!==e?t:{},f=u.MutationObserver||u.WebKitMutationObserver,l="undefined"!=typeof global?global:this,p=[];c="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?n():f?i():o(),r.asap=a}),r("promise/cast",["exports"],function(t){"use strict";function e(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=this;return new e(function(e){e(t)})}t.cast=e}),r("promise/config",["exports"],function(t){"use strict";function r(t,r){return 2!==arguments.length?n[t]:(n[t]=r,e)}var n={instrument:!1};t.config=n,t.configure=r}),r("promise/polyfill",["./promise","./utils","exports"],function(e,r,n){"use strict";function i(){var e="Promise"in t&&"cast"in t.Promise&&"resolve"in t.Promise&&"reject"in t.Promise&&"all"in t.Promise&&"race"in t.Promise&&function(){var e;return new t.Promise(function(t){e=t}),s(e)}();e||(t.Promise=o)}var o=e.Promise,s=r.isFunction;n.polyfill=i}),r("promise/promise",["./config","./utils","./cast","./all","./race","./resolve","./reject","./asap","exports"],function(t,r,n,i,o,s,a,c,u){"use strict";function f(t){if(!j(t))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof f))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[],l(t,this)}function l(t,e){function r(t){v(e,t)}function n(t){g(e,t)}try{t(r,n)}catch(i){n(i)}}function p(t,e,r,n){var i,o,s,a,c=j(r);if(c)try{i=r(n),s=!0}catch(u){a=!0,o=u}else i=n,s=!0;d(e,i)||(c&&s?v(e,i):a?g(e,o):t===O?v(e,i):t===S&&g(e,i))}function h(t,e,r,n){var i=t._subscribers,o=i.length;i[o]=e,i[o+O]=r,i[o+S]=n}function m(t,e){for(var r,n,i=t._subscribers,o=t._detail,s=0;i.length>s;s+=3)r=i[s],n=i[s+e],p(e,r,n,o);t._subscribers=null}function d(t,r){var n,i=null;try{if(t===r)throw new TypeError("A promises callback cannot return that same promise.");if(x(r)&&(i=r.then,j(i)))return i.call(r,function(i){return n?!0:(n=!0,r!==i?v(t,i):y(t,i),e)},function(r){return n?!0:(n=!0,g(t,r),e)}),!0}catch(o){return n?!0:(g(t,o),!0)}return!1}function v(t,e){t===e?y(t,e):d(t,e)||y(t,e)}function y(t,e){t._state===R&&(t._state=U,t._detail=e,A.async(w,t))}function g(t,e){t._state===R&&(t._state=U,t._detail=e,A.async(b,t))}function w(t){m(t,t._state=O)}function b(t){m(t,t._state=S)}var A=t.config;t.configure;var x=r.objectOrFunction,j=r.isFunction;r.now;var T=n.cast,P=i.all,_=o.race,C=s.resolve,G=a.reject,E=c.asap;A.async=E;var R=void 0,U=0,O=1,S=2;f.prototype={constructor:f,_state:e,_detail:e,_subscribers:e,then:function(t,e){var r=this,n=new this.constructor(function(){});if(this._state){var i=arguments;A.async(function(){p(r._state,n,i[r._state-1],r._detail)})}else h(this,n,t,e);return n},"catch":function(t){return this.then(null,t)}},f.all=P,f.cast=T,f.race=_,f.resolve=C,f.reject=G,u.Promise=f}),r("promise/race",["./utils","exports"],function(t,e){"use strict";function r(t){var e=this;if(!n(t))throw new TypeError("You must pass an array to race.");return new e(function(e,r){for(var n,i=0;t.length>i;i++)n=t[i],n&&"function"==typeof n.then?n.then(e,r):e(n)})}var n=t.isArray;e.race=r}),r("promise/reject",["exports"],function(t){"use strict";function e(t){var e=this;return new e(function(e,r){r(t)})}t.reject=e}),r("promise/resolve",["exports"],function(t){"use strict";function e(t){var e=this;return new e(function(e){e(t)})}t.resolve=e}),r("promise/utils",["exports"],function(t){"use strict";function e(t){return r(t)||"object"==typeof t&&null!==t}function r(t){return"function"==typeof t}function n(t){return"[object Array]"===Object.prototype.toString.call(t)}var i=Date.now||function(){return(new Date).getTime()};t.objectOrFunction=e,t.isFunction=r,t.isArray=n,t.now=i}),n("promise/polyfill").polyfill()}(),function(){var r=t!==e?t:exports,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=function(){try{document.createElement("$")}catch(t){return t}}();r.btoa||(r.btoa=function(t){for(var e,r,o=0,s=n,a="";t.charAt(0|o)||(s="=",o%1);a+=s.charAt(63&e>>8-8*(o%1))){if(r=t.charCodeAt(o+=.75),r>255)throw i;e=e<<8|r}return a}),r.atob||(r.atob=function(t){if(t=t.replace(/=+$/,""),1==t.length%4)throw i;for(var e,r,o=0,s=0,a="";r=t.charAt(s++);~r&&(e=o%4?64*e+r:r,o++%4)?a+=String.fromCharCode(255&e>>(6&-2*o)):0)r=n.indexOf(r);return a})}(),AeroGear.ajax=function(t){return new Promise(function(e,r){t=t||{};var n,i,o=new XMLHttpRequest,s=this,a=(t.type||"GET").toUpperCase(),c=(t.dataType||"json").toLowerCase(),u=(t.accept||"application/json").toLowerCase(),f=(t.contentType||"application/json").toLowerCase(),l=[],p=t.url,h=t.data;if(t.params)if("GET"===a||"POST"===a&&"application/x-www-form-urlencoded"===f)for(i in t.params)l.push(encodeURIComponent(i)+"="+encodeURIComponent(t.params[i]||""));else"application/json"===f&&(h=h||{},h.params=h.params||{},AeroGear.extend(h.params,t.params));if("application/x-www-form-urlencoded"===f){if(h)for(i in h)l.push(encodeURIComponent(i)+"="+encodeURIComponent(h[i]));h=l.join("&")}if("GET"===a&&l.length>0&&(p+="?"+l.join("&")),o.open(a,p,!0,t.username,t.password),o.responseType=c,o.setRequestHeader("Content-Type",f),o.setRequestHeader("Accept",u),t.headers)for(n in t.headers)o.setRequestHeader(n,t.headers[n]);o.onload=function(){var t=400>o.status?"success":"error",n=s._createPromiseValue(o,t);return"success"===t?e(n):r(n)},o.onerror=function(){var t="error";r(s._createPromiseValue(o,t))},this._createPromiseValue=function(t,e){var r=t.statusText||e,n="text"===c||""===c?t.responseText:t.response;return{data:n,statusText:r,agXHR:t}},o.send(h)})},function(r){r.UnifiedPushClient=function(n,i,o){if(!n||!i||!o)throw"UnifiedPushClientException";return this instanceof r.UnifiedPushClient?(o="/"===o.substr(-1)?o:o+"/",this.registerWithPushServer=function(e){e=e||{};var s=e.metadata||{};if(!s.deviceToken)throw"UnifiedPushRegistrationException";return s.categories=Array.isArray(s.categories)?s.categories:s.categories?[s.categories]:[],r.ajax({contentType:"application/json",dataType:"json",type:"POST",url:o+"rest/registry/device",headers:{Authorization:"Basic "+t.btoa(n+":"+i)},data:JSON.stringify(s)})},this.unregisterWithPushServer=function(e){return r.ajax({contentType:"application/json",dataType:"json",type:"DELETE",url:o+"rest/registry/device/"+e,headers:{Authorization:"Basic "+t.btoa(n+":"+i)}})},e):new r.UnifiedPushClient(n,i,o)}}(AeroGear)})(this);
//@ sourceMappingURL=aerogear.js.map